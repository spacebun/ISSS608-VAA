---
title: "Take-home Exercise 4"
subtitle: "Prototyping Modules for Visual Analytics Shiny Application"
date: February 25, 2024
date-modified:  last-modified
format:
  html:
    toc: true
    number-sections: true
    code-line-numbers: true
    
execute: 
  eval: true
  echo: true
  warning: false  
---

# Overview

In this exercise, I will use a module of the Shiny application for the Group Project component to fulfill the following objectives:

-   To evaluate and determine what are the necessary R packages needed for the Shiny application supported in R CRAN,

-   To prepare and test the specific R codes can be run and returned the correct output as expected,

-   To determine the parameters and outputs that will be exposed on the Shiny applications, and

-   To select the appropriate Shiny UI components for exposing the parameters determined above.

My submission includes:

-   The prototype module report, that provides detailed discussion and explanation of:

    -   the **data preparation** process,

    -   the selection of **data visualisation techniques** used,

    -   and the data visualisation design and interactivity principles and best practices implemented.

-   The proposed UI design for the different components of the UI.

# Project details

For our project, **AirWeather Analytics,** we aim to create a Shiny app with user-friendly functionalities to effectively visualize and analyze climate and air quality data.

For this exercise we will focus on the module using time series methods to explore trends in the data from specific time periods, and identify patterns into clusters based on their associations.

# Getting started

## Load packages

First, we load packages required:

-   **tidyverse**: to support tasks such as reading in packages or data manipulation

-   **naniar**: for using *miss_vis()* function to check data for missing values

-   **imputeTS**: for using *na_ma()* function to impute missing values

-   **DT**: for using *datatable()* to view the dataset interactively

-   **lubridate**: for handling date-time formats

```{r}
pacman::p_load(tidyverse, naniar,imputeTS, DT, lubridate)

# pacman::p_load(ggplot2, patchwork, 
#                ggridges, ggdist, ggstatsplot,
#                plotly, ggiraph, DT, ggdist, 
#                ungeviz, crosstalk, 
#                viridis)
```

## Import data

```{r}
weather_data <- read_rds("data/weather_imputed.rds")
pm25_hourly_data <- read_rds("../data/pm25_hourly.rds")
psi_24h_data <- read_rds("../data/psi_24h.rds")
```

Details of datasets:

| Dataset        | Description                                            | Period                 | Source of raw data                                                                   |
|-------------|---------------|-------------|-----------------------|
| *weather_data* | Historical climate data for 63 weather stations        | 2014-2023              | <http://www.weather.gov.sg/climate-historical-daily/>                                |
| *pm25_hourly*  | Historical regional 1-hr PM2.5 value measured in µg/m3 | April 2014 to Dec 2022 | [Data.gov.sg: Historical 24-hr PSI](https://beta.data.gov.sg/collections/1380/view)  |
| *psi_24h*      | Historical regional 24-hr PSI                          | April 2014 to Dec 2022 | [Data.gov.sg: Historical 24-hr PSI](https://beta.data.gov.sg/collections/1380/view). |

# Data Preparation

\<to be updated\>

## Import cleaned data

```{r}
weather_data <- read_rds("data/weather_imputed.rds") 
pm25_hourly_data <- read_rds("data/pm25_hourly.rds") 
psi_24h_data <- read_rds("data/psi_24h.rds")
```

#### Details of the cleaned datasets:

| Cleaned Dataset | Description                                            | Period    | Source of raw data                                                                  |
|-----------------|-----------------|-----------------|-----------------------|
| *weather_data*  | Historical climate data for 7 weather stations         | 2021-2023 | <http://www.weather.gov.sg/climate-historical-daily/>                               |
| *pm25_hourly*   | Historical regional 1-hr PM2.5 value measured in µg/m3 | 2020-2022 | [Data.gov.sg: Historical 24-hr PSI](https://beta.data.gov.sg/collections/1380/view) |
| *psi_24h*       | Historical regional 24-hr PSI                          | 2020-2022 | [Data.gov.sg: Historical 24-hr PSI](https://beta.data.gov.sg/collections/1380/view) |

# Climate data: *weather_data*

## Exploratory Data Analysis

Let's look at the structure of the data.

```{r}
str(weather_data)
```

The data has 7665 rows and 10 columns.

Let's summarise some details about the data:

```{r}
# | code-fold: true
# Check number of stations
cat(sprintf("There are %d stations", n_distinct(weather_data$Station)))

unique(weather_data$Station)

# Check time period of data
time_period_start <- min(weather_data$Date)
time_period_end <- max(weather_data$Date)
cat("\nThe time period of the filtered dataset is from", format(time_period_start, "%Y-%m-%d"),"to", format(time_period_end, "%Y-%m-%d"), "\n")

```

-   There are 7 stations: Ang Mo Kio, Changi, Choa Chu Kang (South), East Coast Parkway, Jurong (West), Pulau Ubin, Seletar
-   The time period of the filtered dataset is from 2021-01-01 to 2023-12-31.

